# Internacionaliza√ß√£o (i18n) - RevSend

Sistema de internacionaliza√ß√£o completo com suporte para m√∫ltiplos idiomas.

## Idiomas Suportados

- üáßüá∑ **Portugu√™s (Brasil)** - `pt-BR` (padr√£o)
- üá∫üá∏ **English (US)** - `en-US`

## Como Usar

### Server Components (Recomendado)

Em Server Components, use as fun√ß√µes helper do servidor:

```typescript
import { getLocale, getMessages, createTranslator } from '@/lib/i18n'

export default async function MyPage() {
  const locale = await getLocale()
  const messages = await getMessages(locale)
  const t = createTranslator(messages)

  return (
    <div>
      <h1>{t('dashboard.title')}</h1>
      <p>{t('dashboard.overview')}</p>
    </div>
  )
}
```

### Client Components

Em Client Components, use o hook `useTranslation`:

```typescript
'use client'

import { useTranslation } from '@/hooks/use-translation'

export function MyComponent() {
  const { t, locale, isLoading } = useTranslation()

  if (isLoading) {
    return <div>Loading...</div>
  }

  return (
    <div>
      <h1>{t('campaigns.title')}</h1>
      <p>{t('campaigns.newCampaign')}</p>
    </div>
  )
}
```

### Language Switcher

Para adicionar um seletor de idioma:

```typescript
import { LanguageSwitcher } from '@/components/language-switcher'
import { getLocale } from '@/lib/i18n'

export default async function Layout() {
  const locale = await getLocale()

  return (
    <header>
      <LanguageSwitcher currentLocale={locale} />
    </header>
  )
}
```

## Estrutura de Mensagens

As tradu√ß√µes est√£o organizadas em categorias:

```
messages/
‚îú‚îÄ‚îÄ pt-BR.json
‚îî‚îÄ‚îÄ en-US.json
```

### Categorias

- `common` - A√ß√µes comuns (save, cancel, delete, etc.)
- `auth` - Autentica√ß√£o (login, register, etc.)
- `dashboard` - Dashboard e m√©tricas
- `campaigns` - Campanhas
- `lists` - Listas de contatos
- `contacts` - Contatos
- `whatsapp` - N√∫meros WhatsApp
- `media` - Biblioteca de m√≠dia
- `templates` - Templates de mensagem
- `reports` - Relat√≥rios
- `settings` - Configura√ß√µes
- `replies` - Respostas
- `errors` - Mensagens de erro
- `success` - Mensagens de sucesso
- `confirmations` - Di√°logos de confirma√ß√£o

## Vari√°veis em Tradu√ß√µes

Use `{variable}` para inserir valores din√¢micos:

**messages/pt-BR.json:**
```json
{
  "welcome": "Bem-vindo, {name}!"
}
```

**Uso:**
```typescript
t('welcome', { name: 'Jo√£o' })
// Output: "Bem-vindo, Jo√£o!"
```

## Adicionar Novo Idioma

### 1. Adicionar ao config

Em `src/lib/i18n.ts`:

```typescript
export const locales = ['pt-BR', 'en-US', 'es-ES'] as const
```

### 2. Criar arquivo de mensagens

Copie `messages/pt-BR.json` para `messages/es-ES.json` e traduza.

### 3. Adicionar flag no Language Switcher

Em `src/components/language-switcher.tsx`:

```typescript
const languages = {
  'pt-BR': { name: 'Portugu√™s (BR)', flag: 'üáßüá∑' },
  'en-US': { name: 'English (US)', flag: 'üá∫üá∏' },
  'es-ES': { name: 'Espa√±ol', flag: 'üá™üá∏' }, // Novo
}
```

## Detec√ß√£o de Idioma

O sistema detecta o idioma nesta ordem:

1. **Cookie** `NEXT_LOCALE` (prefer√™ncia do usu√°rio)
2. **Default** `pt-BR` (fallback)

O idioma √© armazenado em cookie com validade de 1 ano.

## API Endpoints

### GET /api/locale

Retorna o idioma atual:

```json
{
  "locale": "pt-BR"
}
```

### POST /api/locale

Altera o idioma:

```json
{
  "locale": "en-US"
}
```

## Boas Pr√°ticas

### ‚úÖ Fazer

- Sempre use chaves descritivas: `campaigns.newCampaign` ‚úÖ
- Agrupe por contexto: `auth.*`, `campaigns.*`
- Use vari√°veis para valores din√¢micos
- Mantenha tradu√ß√µes curtas e claras
- Teste em todos os idiomas antes de fazer deploy

### ‚ùå Evitar

- Chaves gen√©ricas: `text1`, `label2` ‚ùå
- Hardcoded strings no c√≥digo ‚ùå
- Tradu√ß√µes muito longas (split em m√∫ltiplas chaves)
- Misturar HTML com tradu√ß√µes (use componentes)

## Exemplos Pr√°ticos

### Formul√°rio de Login

```typescript
// Server Component
import { getLocale, getMessages, createTranslator } from '@/lib/i18n'

export default async function LoginPage() {
  const locale = await getLocale()
  const messages = await getMessages(locale)
  const t = createTranslator(messages)

  return (
    <div>
      <h1>{t('auth.loginTitle')}</h1>
      <p>{t('auth.loginDescription')}</p>

      <form>
        <label>{t('auth.email')}</label>
        <input type="email" required />

        <label>{t('auth.password')}</label>
        <input type="password" required />

        <button type="submit">{t('auth.signIn')}</button>
      </form>

      <p>
        {t('auth.noAccount')}{' '}
        <a href="/register">{t('auth.createAccount')}</a>
      </p>
    </div>
  )
}
```

### Toast com Mensagem de Erro

```typescript
'use client'

import { useTranslation } from '@/hooks/use-translation'
import { toast } from 'sonner'

export function MyComponent() {
  const { t } = useTranslation()

  const handleError = () => {
    toast.error(t('errors.generic'))
  }

  const handleSuccess = () => {
    toast.success(t('success.saved'))
  }

  return <button onClick={handleSave}>Save</button>
}
```

### Lista de Status de Campanha

```typescript
const statusLabels = {
  draft: t('campaigns.status.draft'),
  running: t('campaigns.status.running'),
  paused: t('campaigns.status.paused'),
  completed: t('campaigns.status.completed'),
}

return <span>{statusLabels[campaign.status]}</span>
```

## Performance

- **Server Components**: Tradu√ß√µes carregadas no servidor (0 JavaScript no client)
- **Client Components**: Tradu√ß√µes lazy-loaded apenas quando necess√°rio
- **Cache**: Messages s√£o cacheados ap√≥s primeiro carregamento
- **Bundle Size**: ~50KB por idioma (gzipped: ~15KB)

## Troubleshooting

### Tradu√ß√£o n√£o aparece

```typescript
// ‚ùå Errado
t('invalidKey')

// ‚úÖ Correto
// 1. Verifique se a chave existe em messages/pt-BR.json
// 2. Use a chave correta: t('auth.loginTitle')
```

### Hook n√£o funciona em Server Component

```typescript
// ‚ùå Errado (Server Component)
'use server' // ou sem 'use client'
import { useTranslation } from '@/hooks/use-translation'

// ‚úÖ Correto (Server Component)
import { getMessages, createTranslator } from '@/lib/i18n'
```

### Idioma n√£o muda ap√≥s trocar

```typescript
// Certifique-se de que o cookie foi setado
// O browser precisa fazer refresh ap√≥s trocar idioma
// O componente LanguageSwitcher j√° faz isso automaticamente
```

## Estat√≠sticas

- **Strings Traduzidas**: ~320 strings
- **Cobertura**: 100% PT-BR, 100% EN-US
- **Categorias**: 13 categorias
- **Idiomas**: 2 (expans√≠vel para mais)
